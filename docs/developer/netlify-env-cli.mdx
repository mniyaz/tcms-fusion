---
sidebar_position: 2
title: Set env vars with Netlify CLI
---

<AuthGate>

# Set environment variables with Netlify CLI

You can push your local `.env` to Netlify using the [Netlify CLI](https://cli.netlify.com/).

## Prerequisites {#prerequisites}

1. **Install Netlify CLI** (if needed):
   ```bash
   npm install -g netlify-cli
   ```
   Or use without installing: `npx netlify ...`

2. **Log in** (once):
   ```bash
   netlify login
   ```

3. **Link this repo to your Netlify site** (once, from project root):
   ```bash
   netlify link
   ```
   Choose your team and site when prompted.

## Import all variables from `.env` {#import-all-variables-from-env}

From the project root, run:

```bash
npm run netlify:env
```

Or directly:

```bash
netlify env:import .env
```

This reads your `.env` file and sets each variable in Netlify for the linked site. You can choose scope (e.g. **All** or **Functions**) and deploy context when prompted.

## Other useful commands {#other-useful-commands}

- **List variables** (names only; values are hidden):
  ```bash
  npm run netlify:env:list
  # or: netlify env:list
  ```

- **Set one variable**:
  ```bash
  netlify env:set VARIABLE_NAME "value"
  ```

- **Get one variable's value**:
  ```bash
  netlify env:get VARIABLE_NAME
  ```

- **Remove a variable**:
  ```bash
  netlify env:unset VARIABLE_NAME
  ```

## Variables used by this project {#variables-used-by-this-project}

| Variable | Purpose |
|----------|--------|
| `DOCS_ADMIN_SECRET` | Bearer token for create/delete/list docs-user APIs |
| `DOCS_SESSION_SECRET` | Signs the session cookie after login |
| `DOCS_USERNAME` / `DOCS_PASSWORD` | Optional fallback login when Hygraph is not used |
| `HYGRAPH_ENDPOINT` | Hygraph Content API URL |
| `HYGRAPH_TOKEN` | Hygraph API token (read/create/delete Gituser) |

Ensure these are set in Netlify (e.g. via `netlify env:import .env`) so the deployed site and serverless functions can authenticate and use Hygraph. Do not put real credentials in docs or scripts—Netlify’s secrets scanner will fail the build if it finds them in the repo or build output.

## Production login not working {#production-login-not-working}

If your env fallback credentials work locally but not in production:

1. **Check scope** – In Netlify: **Site settings → Environment variables**. For `DOCS_USERNAME`, `DOCS_PASSWORD`, `DOCS_SESSION_SECRET`, and any Hygraph vars, the **scope** must include **Functions** (or **All**). If a variable is only scoped to "Builds", the login function will not see it at runtime.
2. **Re-import** – From the project root run `npm run netlify:env:set` (or `netlify env:import .env`), then in the Netlify UI ensure each variable has **Functions** (or **All**) selected under "Scopes".
3. **Redeploy** – After changing env vars, trigger a new deploy (e.g. push a commit or "Clear cache and deploy site") so functions use the latest values.

</AuthGate>
